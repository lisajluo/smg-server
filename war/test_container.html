<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Servlet Test</title>
  <script type="text/javascript" src="../resources/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="../resources/json2.js"></script>
</head>
<body>
<h3> Test Page</h3>

<p><a href = "#" id = "nonCORSlink">nonCORS AJAX</a></p>
<a href = "#" id = "CORSlink">CORS AJAX</a>
<br><a href = "#" id = "NewMatch">Insert New Match</a>
<br><a href = "#" id = "NewMatch_parse_error">Insert New Match_parse error</a>
<p><a href = "#" id = "MakeMove">Make A Move</a></p>
<p><a href = "#" id = "GetMatchInfo">Get Match Info</a></p>


<script type="text/javascript">

$(document).ready(function() {
  $("#nonCORSlink").on("click", function(event) {
    ajaxCall("http://localhost:8888/smg_server");
  });

  $("#CORSlink").on("click", function(event) {
    ajaxCall("http://localhost:8888/test");
  });
  
  $("#NewMatch").on("click", function(event) {
    ajaxCallNewMatch("http://localhost:8888/matches");
  });
  
  $("#NewMatch_parse_error").on("click", function(event) {
    ajaxCallNewMatch_parse_error("http://localhost:8888/matches");
  });
  
  $("#MakeMove").on("click", function(event) {
      var jsonObj = {
          "accessSignature": "HJJIIKKSJF",
          'playerIds': [5348024557502464,6473924464345088],
          "operations": [
              {
                  "value": "sd",
                  "type": "Set",
                  "visibleToPlayerIds": "ALL",
                  "key": "k"
              },
              {
                  "to": 54,
                  "from": 23,
                  "type": "SetRandomInteger",
                  "key": "xcv"
              }
          ]
      };
      $.ajax({
        url: "http://localhost:8888/matches/1231231", 
        type: "POST",
        dataType: 'json',
        data: JSON.stringify(jsonObj),
        success: function(data, textStatus, jqXHR) {
          alert("SUCCESS");
        },
        error: function(jqXHR, textStatus, errorThrown) {
          alert("ERROR: " + textStatus + " " + errorThrown);
        }});
  });
  $("#GetMatchInfo").on("click", function(event) {
      $.ajax({
        url: "http://localhost:8888/matches/123123?accessSignature=HJJIIKKSJF&playerId=5348024557502464", 
        type: "GET",
        success: function(data, textStatus, jqXHR) {
          alert("SUCCESS");
        },
        error: function(jqXHR, textStatus, errorThrown) {
          alert("ERROR: " + textStatus + " " + errorThrown);
        }});
  });
});

function ajaxCall(url) {
  var jsonObj = { "key": "value2" };
  $.ajax({
    url: url, 
    type: "GET",
    success: function(data, textStatus, jqXHR) {
      alert("SUCCESS");
    },
    error: function(jqXHR, textStatus, errorThrown) {
      alert("ERROR: " + textStatus + " " + errorThrown);
    }});
}

function ajaxCallNewMatch(url) {
  var jsonObj = { 'accessSignature': 'HJJIIKKSJF',
                  'playerIds': [5348024557502464,6473924464345088],
                  'gameId': 4644337115725824 }
  $.ajax({
    url: url, 
    type: 'POST',
    dataType: 'json',
    data: JSON.stringify(jsonObj),
    success: function(data, textStatus, jqXHR) {     
      alert("error: " + data['error'] + " matchId: " + data['matchId']);
    },
    error: function(jqXHR, textStatus, errorThrown) {
      alert("ERROR: " + textStatus + " " + errorThrown);
    }
    });
}

function ajaxCallNewMatch_parse_error(url) {
  var jsonObj = { 'accessSignature': 'HJJIIKKSJF',
                  'playerIds': [5348024557502464,6473924464345088],
                  'gameId': 4644337115725824 }
  $.ajax({
    url: url, 
    type: 'POST',
    dataType: 'json',
    data: 'dfdf=sdfsdf',
    success: function(data, textStatus, jqXHR) {     
      alert("error: " + data['error'] + " matchId: " + data['matchId']);
    },
    error: function(jqXHR, textStatus, errorThrown) {
      alert("ERROR: " + textStatus + " " + errorThrown);
    }
    });
}
</script>
</body>
</html>